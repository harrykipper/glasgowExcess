# age$class<-NULL
# age$occupation<-NULL
rbind(lpl_agents,age)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
fava
fava
length(fava)
agents<-data.frame()
fava<-data.frame()
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
age<-round(runif(x[3],x[1],x[2]))
age<-as.data.frame(age)
age$sex<-"M"
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,age)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
lpl_agents<-rbind(lpl_agents,as.data.frame(fava[1:length(fava)]))
as.data.frame(fava[1:length(fava)])
fava[1:length(fava)]
lpl_agents
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
age<-round(runif(x[3],x[1],x[2]))
age<-as.data.frame(age)
age$sex<-"M"
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,age)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
lpl_agents<-rbind(lpl_agents,as.data.frame(fava[1:length(fava)]))
fava[1:length(fava)]
as.data.frame(fava[1:length(fava)])
fava
for(i in 1:length(fava)){
lpl_agents<-rbind(lpl_agents,as.data.frame(fava[i]))
}
lpl_agents
nrow(lpl_agents)
gla_pop<-read.csv("../glasgow-age_classes_1951.csv")
gla_pop
?rbind
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
ageM<-round(runif(x[3],x[1],x[2]))
ageM<-as.data.frame(ageM)
ageM$sex<-"M"
ageF<-round(runif(x[4],x[1],x[2]))
ageF<-as.data.frame(ageF)
ageF$sex<-"F"
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,ageM)
rbind(agents,ageF)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
for(i in 1:length(fava)){
lpl_agents<-rbind(lpl_agents,as.data.frame(fava[i]))
}
lpl_agents
nrow(lpl_agents)
unique(lpl_agents$sex)
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
ageM<-round(runif(x[3],x[1],x[2]))
ageM<-as.data.frame(ageM)
ageM$sex<-"M"
ageF<-round(runif(x[4],x[1],x[2]))
ageF<-as.data.frame(ageF)
ageF$sex<-"F"
# age$class<-NULL
# age$occupation<-NULL
all<-rbind(agents,ageM)
all<-rbind(all,ageF)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
ageM<-round(runif(x[3],x[1],x[2]))
ageM<-as.data.frame(ageM)
ageM$sex<-"M"
ageF<-round(runif(x[4],x[1],x[2]))
ageF<-as.data.frame(ageF)
ageF$sex<-"F"
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,ageM,ageF)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
for(i in 1:length(fava)){
lpl_agents<-rbind(lpl_agents,as.data.frame(fava[i]))
}
fava
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x){
ageM<-round(runif(x[3],x[1],x[2]))
ageM<-as.data.frame(ageM)
ageM$sex<-"M"
ageF<-round(runif(x[4],x[1],x[2]))
ageF<-as.data.frame(ageF)
ageF$sex<-"F"
# age$class<-NULL
# age$occupation<-NULL
m<-rbind(agents,ageM)
rbind(m,ageF)
}
fava<-future_apply(lpl_pop,1,create_agents,future.seed=TRUE)
fava
agents<-data.frame()
lpl_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x,s){
val<-ifelse(s=="M",3,4)
age<-round(runif(x[val],x[1],x[2]))
age<-as.data.frame(age)
age$sex<-s
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,age)
}
maschi<-future_apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
femine
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
nrow(lpl_agents)
gla_pop
gla_agents<-data.frame()
fava<-data.frame()
maschi<-future_apply(gla_pop,1,create_agents,s="M",future.seed=TRUE)
femine<-future_apply(gla_pop,1,create_agents,s="F",future.seed=TRUE)
for(i in 1:length(maschi)){
gla_agents<-rbind(gla_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
gla_agents<-rbind(gla_agents,as.data.frame(femine[i]))
}
nrow(gla_agents)
head(gla_agents)
nrow(gla_agents)
nrow(lpl_agents)
library(future.apply)
create_agents<-function(x,s){
val<-ifelse(s=="M",3,4)
age<-round(runif(x[val],x[1],x[2]))
age<-as.data.frame(age)
age$sex<-s
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,age)
}
lpl_pop<-read.csv("../liverpool-age_classes_1951.csv")
gla_pop<-read.csv("../glasgow-age_classes_1951.csv")
agents<-data.frame()
lpl_agents<-data.frame()
gla_agents<-data.frame()
fava<-data.frame()
maschi<-future_apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
maschi
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
nrow(lpl_agents)
maschi<-future_apply(gla_pop,1,create_agents,s="M",future.seed=TRUE)
femine<-future_apply(gla_pop,1,create_agents,s="F",future.seed=TRUE)
for(i in 1:length(maschi)){
gla_agents<-rbind(gla_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
gla_agents<-rbind(gla_agents,as.data.frame(femine[i]))
}
nrow(gla_agents)
head(gla_agents)
agents<-data.frame()
lpl_agents<-data.frame()
gla_agents<-data.frame()
fava<-data.frame()
maschi<-apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
maschi<-apply(lpl_pop,1,create_agents,s="M")
femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
lpl_pop<-read.csv("../liverpool-age_classes_1951.csv")
gla_pop<-read.csv("../glasgow-age_classes_1951.csv")
agents<-data.frame()
lpl_agents<-data.frame()
gla_agents<-data.frame()
fava<-data.frame()
create_agents<-function(x,s){
val<-ifelse(s=="M",3,4)
age<-round(runif(x[val],x[1],x[2]))
age<-as.data.frame(age)
age$sex<-s
# age$class<-NULL
# age$occupation<-NULL
rbind(agents,age)
}
lpl_pop<-read.csv("../liverpool-age_classes_1951.csv")
gla_pop<-read.csv("../glasgow-age_classes_1951.csv")
agents<-data.frame()
lpl_agents<-data.frame()
gla_agents<-data.frame()
fava<-data.frame()
maschi<-apply(lpl_pop,1,create_agents,s="M")
#maschi<-future_apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
#femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
femine<-apply(lpl_pop,1,create_agents,s="F")
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
#maschi<-future_apply(gla_pop,1,create_agents,s="M",future.seed=TRUE)
maschi<-apply(gla_pop,1,create_agents,s="M")
#femine<-future_apply(gla_pop,1,create_agents,s="F",future.seed=TRUE)
femine<-apply(gla_pop,1,create_agents,s="F")
for(i in 1:length(maschi)){
gla_agents<-rbind(gla_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
gla_agents<-rbind(gla_agents,as.data.frame(femine[i]))
}
glasgow<-read.csv("../glasgow_wards.csv")
glasgow
glasgow$houses<-glasgow$pop1951/glasgow$ppr/glasgow$roomsPerHouse
glasgow
glasgow$houses<-round(glasgow$pop1951/glasgow$ppr/glasgow$roomsPerHouse)
glasgow
glasgow$personsPerHouse<-round(glasgow$pop1951/glasgow$houses)
glasgow
glasgow$personsPerHouse<-glasgow$pop1951/glasgow$houses
glasgow
glasgow<-read.csv("../glasgow_wards.csv")
glasgow$houses<-round(glasgow$pop1951/glasgow$ppr/glasgow$roomsPerHouse)
glasgow$pph<-glasgow$pop1951/glasgow$houses
glasgow
write.csv(glasgow,"../glasgow_wards_elaborated.csv")
glasgow
gla_agents
nrow(lpl_agents[lpl_agents$age>16 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>14 & lpl_agents$sex=="M",])
work_lpl<-read.csv("../liverpool-occupation_1951_clean.csv")
work_lpl
work_lpl[93]
work_lpl[93,]
work_lpl[93,3:4]
lpl_agents
lpl_agents$occupation<-NULL
lpl_agents
lpl_agents$occupation<- NULL
lpl_agents
lpl_agents$occupation<-"NULL"
lpl_agents
lpl_agents$occupation<-NULL
lpl_agents
students<-work_lpl[93,3:4]
retired<-work_lpl[94,3:4]
retired
nrow(lpl_agents[lpl_agents$age>66,])
work_lpl
nrow(lpl_agents[lpl_agents$age>70,])
nrow(lpl_agents[lpl_agents$age<70,])
nrow(lpl_agents[lpl_agents$age>65 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>70 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>65 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>67 & lpl_agents$sex=="M",])
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]
order(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
lpl_agents[lpl_agents$age<22 & lpl_agents$sex=="M",]
nrow(lpl_agents[lpl_agents$age<22 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age<21 & lpl_agents$sex=="M",])
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]
nrow(lpl_agents[lpl_agents$age<21 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
sort(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
sort(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]$age)
sort(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]$age)
?sort
sort(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
x<-sort(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]$age)
x
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",])
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",1:19000])
nrow(lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",1:1900])
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",1:1900]
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]
retired
ret<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",]
ret
ret<-ret[1:1900,]
ret
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19000]
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19000,]
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19000,]$occupation<-"Retired"
lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19000,]
ret<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19000,]
ret$occupation<-"Retired"
ret
work_lpl
lpl_agents[lpl_agents$age>14 & lpl_agents$age<22,]
nrow(lpl_agents[lpl_agents$age>14 & lpl_agents$age<22,])
nrow(lpl_agents[lpl_agents$age>14 & lpl_agents$age<19,])
work_lpl
nrow(lpl_agents[lpl_agents$age>14 & lpl_agents$age<19,])
retM<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:19078,]
retF<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:3922,]
retM$occupation<-"Retired"
retF$occupation<-"Retired"
ret<-rbind(retM,retF)
ret
work_lpl[94,3]
students
students[1]
students[2]
students<-work_lpl[93,3:4]
retired<-work_lpl[94,3:4]
retM<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:retired[1],]
retired
retired[1]
1:retired[1]
1:as.numeric(retired[1])
retM
retF
retM<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:as.numeric(retired[1]),]
retF<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="F",][1:as.numeric(retired[2]),]
stuM<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="M",][1:as.numeric(students[1]),]
stuF<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="F",][1:as.numeric(students[2]),]
retF
work_lpl
lpl_agents<-lpl_agents[-lpl_agents$age>66 & lpl_agents$sex=="M",][1:as.numeric(retired[1]),]
agents<-data.frame()
lpl_agents<-data.frame()
gla_agents<-data.frame()
fava<-data.frame()
maschi<-apply(lpl_pop,1,create_agents,s="M")
#maschi<-future_apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
#femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
femine<-apply(lpl_pop,1,create_agents,s="F")
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
#maschi<-future_apply(gla_pop,1,create_agents,s="M",future.seed=TRUE)
maschi<-apply(gla_pop,1,create_agents,s="M")
#femine<-future_apply(gla_pop,1,create_agents,s="F",future.seed=TRUE)
femine<-apply(gla_pop,1,create_agents,s="F")
for(i in 1:length(maschi)){
gla_agents<-rbind(gla_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
gla_agents<-rbind(gla_agents,as.data.frame(femine[i]))
}
students<-work_lpl[93,3:4]
retired<-work_lpl[94,3:4]
nrow(lpl_agents)
retM<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:as.numeric(retired[1]),]
lpl_agents<-lpl_agents[-lpl_agents$age>66 & lpl_agents$sex=="M",][1:as.numeric(retired[1]),]
retF<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="F",][1:as.numeric(retired[2]),]
lpl_agents<-lpl_agents[-lpl_agents$age>66 & lpl_agents$sex=="F",][1:as.numeric(retired[2]),]
stuM<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="M",][1:as.numeric(students[1]),]
lpl_agents<-lpl_agents[-lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="M",][1:as.numeric(students[1]),]
stuF<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="F",][1:as.numeric(students[2]),]
lpl_agents<-lpl_agents[-lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="F",][1:as.numeric(students[2]),]
nrow(lpl_agents)
lpl_agents<-data.frame()
agents<-data.frame()
fava<-data.frame()
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
nrow(lpl_agents)
maschi<-apply(lpl_pop,1,create_agents,s="M")
#maschi<-future_apply(lpl_pop,1,create_agents,s="M",future.seed=TRUE)
#femine<-future_apply(lpl_pop,1,create_agents,s="F",future.seed=TRUE)
femine<-apply(lpl_pop,1,create_agents,s="F")
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
nrow(lpl_agents)
lpl_agents<-data.frame()
fava<-data.frame()
nrow(lpl_agents)
for(i in 1:length(maschi)){
lpl_agents<-rbind(lpl_agents,as.data.frame(maschi[i]))
}
for(i in 1:length(femine)){
lpl_agents<-rbind(lpl_agents,as.data.frame(femine[i]))
}
nrow(lpl_agents)
head(lpl_agents)
lpl_agents$idx<-rownames(lpl_agents)
head(lpl_agents)
retM<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="M",][1:as.numeric(retired[1]),]
nrow(lpl_agents)
lpl_agents<-lpl_agents[-retM]
lpl_agents<-lpl_agents[-retM,]
lpl_agents<-lpl_agents[!lpl_agents$idx %in% retM$idx,]
nrow(lpl_agents)
retF<-lpl_agents[lpl_agents$age>66 & lpl_agents$sex=="F",][1:as.numeric(retired[2]),]
lpl_agents<-lpl_agents[!lpl_agents$idx %in% retF$idx,]
stuM<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="M",][1:as.numeric(students[1]),]
lpl_agents<-lpl_agents[!lpl_agents$idx %in% stuM$idx,]
stuF<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<19 & lpl_agents$sex=="F",][1:as.numeric(students[2]),]
lpl_agents<-lpl_agents[!lpl_agents$idx %in% stuF$idx,]
nrow(lpl_agents)
retM$occupation<-"Retired"
retF$occupation<-"Retired"
stuM$occupation<-"Student"
stuF$occupation<-"Student"
head(stuF)
work_lpl
lpl_pop
work_lpl[1]
work_lpl[2]
work_lpl[3]
work_lpl[4]
lpl_occ<-lpl_agents[lpl_agents$age>14 & lpl_agents$age<69,]
nrow(lpl_occ)
nrow(lpl_agents)
lpl_occ
head(lpl_occ)
lpl_occ[1:4]
lpl_occ[1:4,]
lpl_occ=lpl_occ[sample(1:nrow(lpl_occ)), ]
lpl_occ[1:4,]
lpl_agents_occupations<-data.frame()
assign_occupation<-function(x){
this<-data.frame()
m<-as.numeric(x[3])
f<-as.numeric(x[4])
t<-x[2]
occM<-lpl_occ[lpl_occ$sex=="M",][1:m,]
occF<-lpl_occ[lpl_occ$sex=="F",][1:f,]
this<-rbind(occM,occF)
this$occupation<-t
lpl_agents_occupations<-rbind(lpl_agents_occupations,this)
}
assign_occupation<-function(x){
this<-data.frame()
m<-as.numeric(x[3])
f<-as.numeric(x[4])
t<-x[2]
occM<-lpl_occ[lpl_occ$sex=="M",][1:m,]
occF<-lpl_occ[lpl_occ$sex=="F",][1:f,]
this<-rbind(occM,occF)
this$occupation<-t
rbind(lpl_agents_occupations,this)
}
lpl_agents_occupations<-apply(work_lpl,1,assign_occupation)
lpl_agents_occupations
nrow(lpl_agents_occupations)
for(i in 1:length(lpl_agents_occupations)){
lpl_agents_occupations<-rbind(lpl_agents_occupations,as.data.frame(lpl_agents_occupations[i]))
}
unlist(lpl_agents_occupations)
lpl_agents_occupations
library(future.apply)
lpl_agents_occupations<-data.frame()
lpl_agents_occupations
lpl_agents_occupations
assign_occupation
lpl_occ
nrow(lpl_occ)
lpl_agents_occupations<-future_apply(work_lpl,1,assign_occupation)
library(future.apply)
lpl_agents_occupations<-future_apply(work_lpl,1,assign_occupation)
head(lpl_agents_occupations)
is.list(lpl_agents_occupations)
as.data.frame(lpl_agents_occupations)
liverpool_agents<-data.frame()
for(i in 1:length(lpl_agents_occupations)){
liverpool_agents<-rbind(liverpool_agents,as.data.frame(lpl_agents_occupations[i]))
}
head(liverpool_agents)
nrow(liverpool_agents)
head(retM)
?future.apply
